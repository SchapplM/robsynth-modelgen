<?xml version="1.0" encoding="UTF-8"?>
<Worksheet>
<Version major="2019" minor="2"/>
<Label-Scheme value="2" prefix=""/>
<View-Properties presentation="false" autoexpanding_sections="true" UserProfileName="Maple Default Profile" NumericFormat-ApplyInteger="true" NumericFormat-ApplyRational="true" NumericFormat-ApplyExponent="false" editable="true">
</View-Properties>
<MapleNet-Properties prettyprint="3" warnlevel="3" compactdisplay="false" preplot="" helpbrowser="standard" displayprecision="-1" echo="1" unitattributes="&quot;fontweight&quot; = &quot;bold&quot;" imaginaryunit="I" longdelim="true" elisiontermsthreshold="10000" elisiondigitsafter="100" elisiondigitsbefore="100" plotdevice="inline" errorbreak="1" plotoptions="" plotdriver="opengl" quiet="false" elisiontermsbefore="100" elisiontermsafter="100" historytimestamp="false" screenwidth="79" indentamount="4" plotoutput="terminal" screenpixelheight="1050" rtablesize="[10, 10]" useclientjvm="true" labelwidth="20" postplot="" typesetting="extended" ansi="false" ansicolor="[]" elisiondigitsthreshold="10000" showassumed="1" ansilprint="false" trailingsemicolon="true" errorcursor="false" labelling="true" screenheight="25" prompt="&gt; " verboseproc="1" latexwidth="8.0" ShowLabels="true"/>
<Styles>
<Font name="Heading 1" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="18" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Warning" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="2D Output" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Heading 4" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="true" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Line Printed Output" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Heading 2" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="16" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Maple Output" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="2D Inert Output" background="[255,255,255]" bold="false" executable="true" family="Times New Roman" foreground="[144,144,144]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Heading 3" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="true" opaque="false" readonly="false" size="14" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Diagnostic" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[40,120,40]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 1" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Maple Input" background="[255,255,255]" bold="true" executable="true" family="Courier New" foreground="[120,0,14]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Text Output" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 2" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 3" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 4" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 5" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Annotation Title" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="18" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Header and Footer" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="10" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="HyperlinkError" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[255,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="Atomic Variable" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[175,0,175]" italic="true" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="HyperlinkWarning" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="Dictionary Hyperlink" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[147,0,15]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="2D Math" background="[255,255,255]" bold="false" executable="true" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Bullet Item" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Maple Plot" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Annotation Text" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="List Item" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Dash Item" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="2D Input" background="[255,255,255]" bold="false" executable="true" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Error" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[255,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Title" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="18" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Text" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Normal" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Caption Reference" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Code" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[255,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Maple Input Placeholder" background="[255,255,255]" bold="true" executable="true" family="Courier New" foreground="[200,0,200]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="true"/>
<Font name="Equation Label" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Author" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Hyperlink" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,128,128]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="Caption Text" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Layout name="Heading 1" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="8" spacebelow="4" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Warning" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Heading 4" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Line Printed Output" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="any" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Heading 2" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="8" spacebelow="2" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Maple Output" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.3" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Heading 3" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Diagnostic" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="any" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Ordered List 1" alignment="left" bullet="numeric" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Text Output" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="newline" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Ordered List 2" alignment="left" bullet="alphabetic" firstindent="0" leftmargin="36" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Ordered List 3" alignment="left" bullet="roman" firstindent="0" leftmargin="72" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Ordered List 4" alignment="left" bullet="ALPHABETIC" firstindent="0" leftmargin="108" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Ordered List 5" alignment="left" bullet="ROMAN" firstindent="0" leftmargin="144" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Annotation Title" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="12" spacebelow="12" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="HyperlinkError" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="HyperlinkWarning" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Bullet Item" alignment="left" bullet="dot" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Maple Plot" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="List Item" alignment="left" bullet="indent" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Dash Item" alignment="left" bullet="dash" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Error" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Title" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="12" spacebelow="12" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Normal" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Author" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="8" spacebelow="8" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Pencil-style name="Pencil 1" pen-color="[0,0,0]" pen-height="1.0" pen-width="1.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 2" pen-color="[0,0,255]" pen-height="1.0" pen-width="1.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 3" pen-color="[0,0,0]" pen-height="3.0" pen-width="3.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 4" pen-color="[0,0,255]" pen-height="3.0" pen-width="3.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 5" pen-color="[255,0,0]" pen-height="5.0" pen-width="5.0" pen-opacity="1.0"/>
<Highlighter-style name="Highlighter 5" pen-color="[255,255,0]" pen-height="48.0" pen-width="48.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 3" pen-color="[51,255,0]" pen-height="24.0" pen-width="24.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 4" pen-color="[0,255,255]" pen-height="32.0" pen-width="32.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 1" pen-color="[255,153,255]" pen-height="12.0" pen-width="8.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 2" pen-color="[255,204,0]" pen-height="14.0" pen-width="14.0" pen-opacity="0.8"/>
</Styles>
<Startup-Code startupcode=""/>
<Task-table>
    <Task-category name="&lt;default&gt;"/>
</Task-table>
<Task/>
<Group labelreference="L1" drawlabel="true">
<Input><Text-field style="Title" layout="Title">Forward Kinematics for Robot based on MDH frames</Text-field>
</Input>
</Group>
<Group labelreference="L1503" drawlabel="true">
<Input><Text-field style="Heading 2" layout="Heading 2">Introduction</Text-field><Text-field style="Normal" layout="Normal">Direkte Kinematik basierend auf MDH-Parametern berechnen

Dateiname:
<Font encoding="UTF-8">robot -&gt; Berechnung f\303\274r allgemeinen Roboter
tree -&gt; Berechnung f\303\274r eine beliebige Baumstruktur (ohne Schleifen)
floatb -&gt; floating base wird durch base twist (Geschwindigkeit der Basis) oder vollst\303\244ndige Orientierung (Euler-Winkel) ber\303\274cksichtigt
</Font>rotmat -&gt; Kinematik wird mit Rotationsmatrizen berechnet
<Font encoding="UTF-8">mdh_kinematics -&gt; Berechnung der Vorw\303\244rtskinematik mit modifizierten DH-Parametern nach </Font>[KhalilKle1986]

Prinzip:
Berechne die direkte Kinematik.</Text-field><Text-field style="Normal" layout="Normal"><Font encoding="UTF-8">Zus\303\244tzlich k\303\266nnen kinematische Zwangsbedingungen direkt ber\303\274cksichtigt werden. Diese sorgen daf\303\274r, dass MDH-Winkel durch analytische Ausdr\303\274cke verallgemeinerter Koordinaten ersetzt werden.</Font></Text-field>
</Input>
</Group>
<Group labelreference="L1501" drawlabel="true">
<Input><Text-field style="Heading 2" layout="Heading 2">Authors</Text-field><Text-field style="Normal" layout="Normal">Moritz Schappler, schappler@irt.uni-hannover.de, 2016-03</Text-field><Text-field style="Normal" layout="Normal">(C) Institut fuer Regelungstechnik, Leibniz Universitaet Hannover</Text-field>
</Input>
</Group>
<Group labelreference="L1502" drawlabel="true">
<Input><Text-field style="Heading 2" layout="Heading 2">Sources</Text-field><Text-field style="Normal" layout="Normal">[KhalilKle1986] Khalil, W. &amp; Kleinfinger, J.: A new geometric notation for open and closed-loop robots (1986)
[KhalilDombre2002] Modeling, Identification and Control of Robots</Text-field><Text-field style="Text" layout="Normal">[Ortmaier2014] Vorlesungsskript Robotik I</Text-field>
</Input>
</Group>
<Section collapsed="false" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1">Initialization</Text-field></Title>
<Group labelreference="L1726" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"><Font encoding="UTF-8">interface(warnlevel=0): # Unterdr\303\274cke die folgende Warnung.
restart: # Gibt eine Warnung, wenn \303\274ber Terminal-Maple mit read gestartet wird.
</Font>interface(warnlevel=3):</Text-field>
</Input>
</Group>
<Group labelreference="L1522" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">with(LinearAlgebra):
with(ArrayTools):
with(codegen):
with(CodeGeneration):
with(StringTools):</Text-field>
</Input>
</Group>
<Group labelreference="L1687" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">codegen_act := true:
codegen_debug := false:
codegen_opt := 2:</Text-field>
</Input>
</Group>
<Group labelreference="L1766" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Code-Optimierung f\303\274r die Kinematik (zusammenfassung paralleler Achsen).</Font></Text-field><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Ist f\303\274r einige Systeme vorteilhaft (serielle Ketten mit parallelen Achsen), f\303\274r andere nicht (z.B. Baumstrukturen mit parallelen Achsen. Hier kann die Code-Optimierung mehr aus nicht trigonometrisch optimierten Termen herausholen).
Die Terme werden aber auf jeden Fall \303\274bersichtlicher.</Font></Text-field>
</Input>
</Group>
<Group labelreference="L1765" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">codegen_kinematics_opt := true:</Text-field>
</Input>
</Group>
<Group labelreference="L1770" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field style="Text" layout="Normal">Substitutionsreihenfolge von kinematischen Zwangsbedingungen (falls vorhanden) einstellen.
<Font encoding="UTF-8">1: Ersetzung bereits in Einzel-Transformationsmatrizen (dann ist die Zusammenfassung f\303\274r mehrere Achsen aus </Font>codegen_kinematics_opt<Font encoding="UTF-8"> nicht mehr so leicht m\303\266glich). Muss 1 sein f\303\274r trigonometrische Ersetzung.
</Font>2: Ersetzung erst nach der Zusammenfassung der Einzel-Transformationsmatrizen zu (kumulierten) Gesamt-Transformationsmatrizen</Text-field>
</Input>
</Group>
<Group labelreference="L1771" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">codegen_kinematics_subsorder := 1:</Text-field>
</Input>
</Group>
<Group labelreference="L1583" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">read &quot;../helper/proc_convert_s_t&quot;:
read &quot;../helper/proc_convert_t_s&quot;: 
read &quot;../helper/proc_MatlabExport&quot;:
read &quot;../helper/proc_simplify2&quot;:
read &quot;../helper/proc_combine2&quot;:</Text-field>
</Input>
</Group>
<Group labelreference="L1523" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">read &quot;../transformation/proc_rotx&quot;: 
read &quot;../transformation/proc_roty&quot;: 
read &quot;../transformation/proc_rotz&quot;: 
read &quot;../transformation/proc_trotx&quot;: 
read &quot;../transformation/proc_troty&quot;: 
read &quot;../transformation/proc_trotz&quot;: 
read &quot;../transformation/proc_transl&quot;: 
read &quot;../transformation/proc_trafo_mdh&quot;: </Text-field>
</Input>
</Group><Presentation-Block>
<Group view="code" labelreference="L2198" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field style="Text" layout="Normal">Funktionen aus Robotik-Repo</Text-field>
</Input>
</Group>
<Group labelreference="L2197" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">read(&quot;../robotics_repo_path&quot;):</Text-field>
</Input>
</Group>
<Group labelreference="L2199" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">read(sprintf(&quot;%s/transformation/maple/proc_eulxyz2r&quot;, robotics_repo_path)):</Text-field>
</Input>
</Group></Presentation-Block>
<Group labelreference="L1857" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Homogene Transformationsmatrix f\303\274r Rotation aus XYZ-Euler-Winkel</Font></Text-field>
</Input>
</Group>
<Group labelreference="L2200" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">eulxyztr := proc (alpha, beta, gamma) 
  local T; 
  T := Matrix(4,4,`&lt;,&gt;`(`&lt;|&gt;`(eulxyz2r(&lt;alpha; beta; gamma&gt;),`&lt;,&gt;`(0,0,0)),`&lt;|&gt;`(0,0,0,1)));
  return T 
end proc:</Text-field>
</Input>
</Group>
<Group labelreference="L1577" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">read &quot;../robot_codegen_definitions/robot_env&quot;:
<Font encoding="UTF-8">printf(&quot;%s. Generiere Kinematik f\303\274r %s\134n&quot;, </Font>FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;), robot_name):</Text-field>
</Input>
</Group>
<Group labelreference="L1645" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">read sprintf(&quot;../codeexport/%s/tmp/tree_floatb_definitions&quot;, robot_name):</Text-field>
</Input>
</Group>
<Group labelreference="L2213" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"><Font encoding="UTF-8">printf(&quot;%s. Alle Daten geladen. Generiere Kinematik f\303\274r %s\134n&quot;, FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;), </Font>robot_name):</Text-field>
</Input>
</Group>
<Group labelreference="L2218" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field style="Text" layout="Normal">Term-Vereinfachungen einstellen</Text-field>
</Input>
</Group><CodeEditor-ExecGroup view="presentation" labelreference="L2220" drawlabel="true" applyint="true" applyrational="true" display="code"><EC-CodeEditor id="CodeEditRegion4" expanded="true" visible="true" pixel-width="500" pixel-height="200" code-language="text/maple" autofit="true" wrapping="true" show-border="true" code-line-numbers="true">if not assigned(simplify_options) or simplify_options(2)=-1 then
  use_simplify := 1: # standardm\303\244\303\237ig simplify-Befehle anwenden. Sind meistens sinnvoll und in Ausnahmen nicht allzu sch\303\244dlich
else
  use_simplify := simplify_options(2): # zweiter Eintrag ist f\303\274r Kinematik
end if:
</EC-CodeEditor></CodeEditor-ExecGroup>
<Group labelreference="L2221" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group>
</Section>
<Section collapsed="false" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1">Kinematische Zwangsbedingungen</Text-field></Title>
<Group labelreference="L1700" drawlabel="true">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Lade Ausdr\303\274cke f\303\274r kinematische Zwangsbedingungen (Verkn\303\274pfung von MDH-Gelenkwinkeln durch verallgemeinerte Koordinaten)</Font></Text-field>
</Input>
</Group>
<Group labelreference="L1695" drawlabel="true">
<Input><Text-field style="Text" layout="Normal">Lese Variablen: kintmp_subsexp, kintmp_qs, kintmp_qt</Text-field>
</Input>
</Group>
<Group labelreference="L1716" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">kin_constraints_exist := false:</Text-field>
</Input>
</Group>
<Group labelreference="L1717" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">read &quot;../robot_codegen_constraints/proc_subs_kintmp_exp&quot;:</Text-field>
</Input>
</Group>
<Group labelreference="L1699" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">constrfile := sprintf(&quot;../codeexport/%s/tmp/kinematic_constraints_maple_inert.m&quot;, robot_name):
if FileTools[Exists](constrfile) then
  read constrfile:
end if:</Text-field>
</Input>
</Group>
<Group labelreference="L1721" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">if kin_constraints_exist = true then:
  kintmp_qs := kintmp_qs: # gelesene Variable sonst nicht sichtbar
  kintmp_qt := kintmp_qt: # gelesene Variable sonst nicht sichtbar
  kintmp_subsexp := kintmp_subsexp:
  printf(&quot;%s. <Font encoding="UTF-8">Kinematische Zwangsbedingungen gelesen.\134n&quot;</Font>, FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;)):
else
  kintmp_qs := Matrix(1,1):
  kintmp_qt := Matrix(1,1):
  kintmp_subsexp := Matrix(1,2):
  kin_constraints_exist := false:
<Font encoding="UTF-8">  # Zwangsbedingungen neu speichern, damit diese auch f\303\274r andere Skripte verf\303\274gbar sind (als dummy-Variablen).
</Font>  save kin_constraints_exist, kintmp_qs, kintmp_qt, kintmp_subsexp, sprintf(&quot;../codeexport/%s/tmp/kinematic_constraints_maple_inert.m&quot;, robot_name):
end if:</Text-field>
</Input>
</Group>
</Section>
<Section collapsed="false" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1">Calculate Forward Kinematics (Single-Joint Transformation)</Text-field></Title>
<Group labelreference="L1124" drawlabel="true">
<Input><Text-field style="Text" layout="Normal">Trf is the Matrix of Transformation from i-1 to i
Trf_c is the cummulated Matrix of Transformation from 0 to i</Text-field>
</Input>
</Group>
<Group labelreference="L2215" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"><Font encoding="UTF-8">printf(&quot;%s. Beginne Berechnung der Kinematik f\303\274r einzelne Gelenk-Transformationen.\134n&quot;, FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;)):</Font></Text-field>
</Input>
</Group>
<Group labelreference="L1680" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">Trf := Matrix(4, 4, NJ): # Diese Initialisierung bringt nichts (initialisiert nur 4x4-Matrix)</Text-field>
</Input>
</Group>
<Group labelreference="L1682" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">for i from 1 to NJ do 
  Trf(1 .. 4, 1 .. 4, i) := Matrix(4,4):
end do:</Text-field>
</Input>
</Group>
<Group labelreference="L1681" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">for i from 1 to NJ do 
  Trf(1 .. 4, 1 .. 4, i) := trafo_mdh_full(alpha[i,1], a[i,1], theta[i,1], d[i,1], beta[i,1], b[i,1]):
end do:</Text-field>
</Input>
</Group>
</Section>
<Section collapsed="false" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1">Kinematische Zwangsbedingungen ersetzen (vor Berechnung der Gesamt-Transformation)</Text-field></Title>
<Group labelreference="L1714" drawlabel="true">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Substituiere allgemeine Ausdr\303\274cke der Winkel der Parallelstruktur mit kinematischen Zwangsbedingungen in Abh\303\244ngigkeit der Haupt-Gelenkwinkel</Font></Text-field>
</Input>
</Group><CodeEditor-ExecGroup view="presentation" labelreference="L2" applyint="true" applyrational="true" display="code"><EC-CodeEditor id="CodeEditRegion0" expanded="true" visible="true" pixel-width="1584" pixel-height="288" code-language="text/maple" autofit="true" wrapping="false" show-border="true" code-line-numbers="true">if kin_constraints_exist and codegen_kinematics_subsorder = 1 then
  for i from 1 to NJ do # Index \303\274ber Transformationsmatrizen aller K\303\266rper
    for ix from 1 to 4 do # Index \303\274ber Zeilen der Transformationsmatrizen
      for iy from 1 to 4 do # Index \303\274ber Spalten der Transformationsmatrizen
        # Substituiere Zeitvariablen
        Trf(ix, iy, i) := convert_t_s( Trf(ix, iy, i) ):
        # Substituiere sin und cos der Winkel (einfachere Ausdr\303\274cke)
        Trf(ix, iy, i) := subs_kintmp_exp(Trf(ix, iy, i)):
        # Substituiere die verbleibenden Winkel direkt (einige Winkel sind nicht in den Ersetzungsausdr\303\274cken enthalten, da sie keine problematischen arctan-Ausdr\303\274cke enthalten.
        for jj from 1 to RowDimension(kintmp_qt) do # Index \303\274ber zu ersetzende Winkel
          Trf(ix, iy, i) := subs( { kintmp_s(jj, 1) = kintmp_qs(jj, 1) }, Trf(ix, iy, i) ): 
        end do:
        Trf(ix, iy, i) := convert_s_t( Trf(ix, iy, i) ):
      end do:
    end do:
    if use_simplify&gt;=1 then
    	 tmp_l1 := length(Trf(1 .. 4, 1 .. 4, i)): tmp_t1:=time():
    	 Trf(1 .. 4, 1 .. 4, i) := simplify2(Trf(1 .. 4, 1 .. 4, i)):
    	 tmp_l2 := length(Trf(1 .. 4, 1 .. 4, i)): tmp_t2:=time():
    	 printf(&quot;%s: Term f\303\274r (Einzel-)Trafo-Matrix %d-&gt;%d vereinfacht. L\303\244nge: %d-&gt;%d. Rechenzeit %1.1fs.\134n&quot;, \134
    	   FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;), v(i), i, tmp_l1, tmp_l2, tmp_t2-tmp_t1):
    end if:
  end do:
  printf(&quot;%s. Ersetzungen der MDH-Parameter mit Ergebnissen der Parallelstruktur in verallgemeinerten Koordinaten erfolgreich (vor Berechnung der Gesamt-Transformation).\134n&quot;, FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;)):
end if:</EC-CodeEditor></CodeEditor-ExecGroup>
</Section>
<Section collapsed="false" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1">Calculate Forward Kinematics (Multi-Joint Transformation)</Text-field></Title>
<Group labelreference="L1706" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">Trf_c := Matrix(4, 4, NJ+1): # Diese Initialisierung bringt nichts (initialisiert nur 4x4-Matrix)</Text-field>
</Input>
</Group>
<Group labelreference="L1705" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">for i from 1 to NJ+1 do 
<Font encoding="UTF-8">  Trf_c(1 .. 4, 1 .. 4, i) := Matrix(4,4): # Vollst\303\244ndige Initialisierung
</Font>end do:</Text-field>
</Input>
</Group>
<Group labelreference="L1711" drawlabel="true">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Basis-Transformation: Unterschiedliche Darstellungsmethoden. F\303\274hren zu unterschiedlichen verallgemeinerten Koordinaten.</Font></Text-field>
</Input>
</Group>
<Group labelreference="L1709" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">if base_method_name = &quot;twist&quot; then:
  Trf_c(1 .. 4, 1 .. 4, 1) := transl(X_base_t[1..3,1]):
end:
if base_method_name = &quot;eulxyz&quot; then:
  Trf_c(1 .. 4, 1 .. 4, 1) := transl(X_base_t[1..3,1]) . eulxyztr(X_base_t[4,1], X_base_t[5,1], X_base_t[6,1]):
end:</Text-field>
</Input>
</Group>
<Group labelreference="L1707" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"><Font encoding="UTF-8">printf(&quot;%s. Beginne direkte Kinematik. Nutze die Methode %s f\303\274r die Basis-Orientierung.\134n&quot;, </Font>FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;), base_method_name):</Text-field>
</Input>
</Group>
<Group labelreference="L1710" drawlabel="true">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Kinematik aller K\303\266rper mit MDH-Ansatz Bestimmen. </Font>[KhalilKle1986].</Text-field>
</Input>
</Group>
<Group labelreference="L1727" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field style="Text" layout="Normal">Einfache Kinematik: Multiplikation an vorherige Transformationsmatrix</Text-field>
</Input>
</Group><CodeEditor-ExecGroup view="presentation" labelreference="L4" applyint="true" applyrational="true" display="code"><EC-CodeEditor id="CodeEditRegion1" expanded="true" visible="true" pixel-width="837" pixel-height="200" code-language="text/maple" autofit="true" wrapping="false" show-border="true" code-line-numbers="true">if not(codegen_kinematics_opt) then
  printf(&quot;%s. Berechne Vorw\303\244rts-Transformation der Kinematik ohne spezielle Optimierung.\134n&quot;, FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;)):
  for i from 1 to NJ do 
    # Index des vorherigen Koordinatensystems
    j := v(i)+1:
    Trf_c(1 .. 4, 1 .. 4, i+1) := Multiply(Trf_c(1 .. 4, 1 .. 4, j), Trf(1 .. 4, 1 .. 4, i)):
    if use_simplify&gt;=1 then
    	 tmp_l1 := length(Trf_c(1 .. 4, 1 .. 4, i+1)): tmp_t1:=time():
    	 Trf_c(1 .. 4, 1 .. 4, i+1) := simplify2(Trf_c(1 .. 4, 1 .. 4, i+1)):
    	 tmp_l2 := length(Trf_c(1 .. 4, 1 .. 4, i+1)): tmp_t2:=time():
    	 printf(&quot;%s: Term f\303\274r (Gesamt-)Trafo-Matrix 0-&gt;%d vereinfacht. L\303\244nge: %d-&gt;%d. Rechenzeit %1.1fs.\134n&quot;, \134
    	   FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;), i, tmp_l1, tmp_l2, tmp_t2-tmp_t1):
    end if:
  end do:
end if:</EC-CodeEditor></CodeEditor-ExecGroup>
<Group labelreference="L1759" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">#Trf_c_orig := copy(Trf_c): # Debug-Ausdruck zum Vergleich der obigen mit der unteren Methode</Text-field>
</Input>
</Group>
<Group labelreference="L1730" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Optimierung der Terme: Summentheorem f\303\274r Drehungen um aufeinanderfolgende Achsen.
Bei Verwendung dieser Optimierung funktioniert die Substitution mit trigonometrischen Ausdr\303\274cken von abh\303\244ngigen Gelenken eventuell anders.
</Font>Die Funktionsweise kann mit aktivierten print-Befehlen nachvollzogen werden.</Text-field>
</Input>
</Group>
<Group labelreference="L2212" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group><CodeEditor-ExecGroup view="presentation" hide-input="false" labelreference="L6" applyint="true" applyrational="true" display="code"><EC-CodeEditor id="CodeEditRegion3" expanded="true" visible="true" pixel-width="1170" pixel-height="702" code-language="text/maple" autofit="true" wrapping="false" show-border="true" code-line-numbers="true">if codegen_kinematics_opt then
  printf(&quot;%s. Beginne mit der Optimierung der Kinematik f\303\274r parallele Gelenke.\134n&quot;, FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;)):
  for i from 1 to NJ do
    #printf(&quot;----------------------\134ni=%d\134n&quot;,i):
    # Bestimme Vorw\303\244rtskinematik f\303\274r das Koordinatensystem i (0=Basis)
    # Gehe solande r\303\274ckw\303\244rts, wie die Gelenkachsen parallel sind
    j := i: # Lauf-Index \303\274ber Vorg\303\244nger-Elemente (0=Basis)
    j2 := 0:# Index des Segmentes (0=Basis), das vor der Kette von parallelen Achsen ist
    Trf_tmp := IdentityMatrix(4,4); # Transformation von diesem Segment zum aktuellen
    Kette_akt := []:
    #printf(&quot;Trf_tmp neu initialisiert:\134n&quot;):
    #print(Trf_tmp);
    for k from 1 to NJ do # Schleife mit Dummy-L\303\244nge. Wird abgebrochen, falls beendet.
      #printf(&quot;j=%d\134n&quot;,j):
      Kette_akt := [j, op(Kette_akt)]:
      # Additionstheorem f\303\274r Drehung um parallele Achsen (combine)
      # Pr\303\274fe, welche Form rechentechnisch am g\303\274nstigsten ist und w\303\244hle diese (wrapper combine2)
      Trf_tmp := simplify2(combine2(Matrix(Trf(1 .. 4, 1 .. 4, j) . Trf_tmp))):
      #printf(&quot;Trf_tmp aktualisiert mit Trf %d. Aktuelle Kette: %s\134n&quot;, j, convert(Kette_akt, string)):
      #print(Trf_tmp);
      if not(alpha(j) = 0) then
        # Die vorherige Achse ist nicht parallel zu dieser
        # Weitere Vereinfachungen ergeben keinen Sinn
        j2 := v(j):
        #printf(&quot;alpha ungleich null. Abbruch j2=%d.\134n&quot;, j2):
        break:
      #else
      #  printf(&quot;alpha ist Null. Vorherige Achse ist parallel\134n&quot;):
      end if:
      if v(j) = 0 then
        break: # Vorg\303\244nger ist Basis. Keine weitere Untersuchung
      end if:
      #printf(&quot;v(%d)=%d\134n&quot;, j, v(j)):
      j := v(j): # Nehme das Vorg\303\244nger-Segment
    end do:
    Trf_c(1 .. 4, 1 .. 4, i+1) := Matrix(Trf_c(1 .. 4, 1 .. 4, j2+1)) . Trf_tmp:
    if use_simplify&gt;=1 then
    	 tmp_l1 := length(Trf_c(1 .. 4, 1 .. 4, i+1)): tmp_t1:=time():
    	 Trf_c(1 .. 4, 1 .. 4, i+1) := simplify2(Trf_c(1 .. 4, 1 .. 4, i+1)):
    	 tmp_l2 := length(Trf_c(1 .. 4, 1 .. 4, i+1)): tmp_t2:=time():
    	 printf(&quot;%s: Term f\303\274r (Gesamt-)Trafo-Matrix 0-&gt;%d vereinfacht. L\303\244nge: %d-&gt;%d. Rechenzeit %1.1fs\134n&quot;, \134
    	   FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;), i, tmp_l1, tmp_l2, tmp_t2-tmp_t1):
    end if:
    #printf(&quot;Trf_tmp an Trf_c angeh\303\244ngt (Eintrag zu K\303\266rper %d. %d -&gt; %d mit Kette %s)\134n&quot;, i, j2, i, convert(Kette_akt, string)):
    #print(Trf_c(1 .. 4, 1 .. 4, i+1)):
  end do:
  printf(&quot;%s. Berechnung der direkten Kinematik mit Vereinfachungen f\303\274r parallele Achsen erfolgreich.\134n&quot;, \134
    FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;)
):
end if:</EC-CodeEditor></CodeEditor-ExecGroup>
<Section collapsed="false" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title>
<Group labelreference="L2206" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input>
</Input>
</Group><Text-field style="Heading 1" layout="Heading 1">Kinematische Zwangsbedingungen ersetzen (nach Berechnung der Gesamt-Transformation)</Text-field></Title>
<Group labelreference="L1856" drawlabel="true">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Substituiere allgemeine Ausdr\303\274cke der Winkel der Parallelstruktur mit kinematischen Zwangsbedingungen in Abh\303\244ngigkeit der Haupt-Gelenkwinkel
Da die Gesamt-Transformation Trf_c an dieser Stelle schon berechnet wurde, m\303\274ssen die Ausdr\303\274cke hier in Trf und Trf_c ersetzt werden.</Font></Text-field>
</Input>
</Group><CodeEditor-ExecGroup view="presentation" labelreference="L2201" applyint="true" applyrational="true" display="code"><EC-CodeEditor id="CodeEditRegion2" expanded="true" visible="true" pixel-width="1584" pixel-height="288" code-language="text/maple" autofit="true" wrapping="false" show-border="true" code-line-numbers="true">if kin_constraints_exist and codegen_kinematics_subsorder = 2 then
  printf(&quot;%s. Beginne Einsetzung der kinematischen Zwangsbedingungen in die direkte Kinematik (Gesamt-Transformation).\134n&quot;, FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;)):
  for i from 1 to NJ do # Index \303\274ber Transformationsmatrizen aller K\303\266rper
    for ix from 1 to 4 do # Index \303\274ber Zeilen der Transformationsmatrizen
      for iy from 1 to 4 do # Index \303\274ber Spalten der Transformationsmatrizen
        # Substituiere Zeitvariablen
        Trf(  ix, iy, i)   := convert_t_s( Trf(  ix, iy, i) ):
        Trf_c(ix, iy, i+1) := convert_t_s( Trf_c(ix, iy, i+1) ):
        # Substituiere sin und cos der Winkel (einfachere Ausdr\303\274cke)
        Trf(ix,   iy, i)   := subs_kintmp_exp(Trf(  ix, iy, i)):
        Trf_c(ix, iy, i+1) := subs_kintmp_exp(Trf_c(ix, iy, i+1)):
        # Substituiere die verbleibenden Winkel direkt (einige Winkel sind nicht in den Ersetzungsausdr\303\274cken enthalten, da sie keine problematischen arctan-Ausdr\303\274cke enthalten.
        for jj from 1 to RowDimension(kintmp_qt) do # Index \303\274ber zu ersetzende Winkel
          Trf(ix,   iy, i)   := subs( { kintmp_s(jj, 1) = kintmp_qs(jj, 1) }, Trf(  ix, iy, i) ):
          Trf_c(ix, iy, i+1) := subs( { kintmp_s(jj, 1) = kintmp_qs(jj, 1) }, Trf_c(ix, iy, i+1) ): 
        end do:
        Trf(ix,   iy, i)   := convert_s_t( Trf(  ix, iy, i) ):
        Trf_c(ix, iy, i+1) := convert_s_t( Trf_c(ix, iy, i+1) ):
      end do:
    end do:
    if use_simplify&gt;=1 then
    	 tmp_l1 := length(Trf(1 .. 4, 1 .. 4, i)): tmp_t1:=time():
    	 Trf(1 .. 4, 1 .. 4, i) := simplify2(Trf(1 .. 4, 1 .. 4, i)):
    	 tmp_l2 := length(Trf(1 .. 4, 1 .. 4, i)): tmp_t2:=time():
    	 printf(&quot;%s. Term f\303\274r Einzel-Trafo-Matrix %d-&gt;%d vereinfacht. L\303\244nge: %d-&gt;%d Rechenzeit %1.1fs.\134n&quot;, \134
    	   FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;), v(i), i, tmp_l1, tmp_l2, tmp_t2-tmp_t1):
    	 tmp_l1 := length(Trf_c(1 .. 4, 1 .. 4, i+1)): tmp_t1:=time():
    	 Trf_c(1 .. 4, 1 .. 4, i+1) := simplify2(Trf_c(1 .. 4, 1 .. 4, i+1)):
    	 tmp_l2 := length(Trf_c(1 .. 4, 1 .. 4, i+1)): tmp_t2:=time():
    	 printf(&quot;%s. Term f\303\274r Gesamt-Trafo-Matrix 0-&gt;%d vereinfacht. L\303\244nge: %d-&gt;%d Rechenzeit %1.1fs.\134n&quot;, \134 
    	   FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;), i, tmp_l1, tmp_l2, tmp_t2-tmp_t1):
    end if:
  end do:
  printf(&quot;%s. Ersetzungen der MDH-Parameter mit Ergebnissen der Parallelstruktur in verallgemeinerten Koordinaten erfolgreich (nach Berechnung der Gesamt-Transformation).\134n&quot;, \134
    FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;)):
end if:</EC-CodeEditor></CodeEditor-ExecGroup>
</Section>
<Section collapsed="false" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1">Export</Text-field></Title>
<Group labelreference="L2214" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"><Font encoding="UTF-8">printf(&quot;%s. Berechnung der Kinematik beendet. Beginne Matlab-Export.\134n&quot;, FormatTime(&quot;%Y-%m-%d %H:%M:%S&quot;)):</Font></Text-field>
</Input>
</Group>
<Group labelreference="L1840" drawlabel="true">
<Input><Text-field style="Text" layout="Normal">Maple-Export</Text-field>
</Input>
</Group>
<Group labelreference="L1849" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">save Trf, Trf_c, sprintf(&quot;../codeexport/%s/tmp/kinematics_floatb_%s_rotmat_maple.m&quot;, robot_name, base_method_name):</Text-field>
</Input>
</Group>
<Group labelreference="L1839" drawlabel="true">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Export des symbolischen Ausdrucks f\303\274r alle kumulierten Transformationsmatrizen auf einmal.</Font></Text-field>
</Input>
</Group>
<Group labelreference="L1841" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">Trf_c_Export := Matrix((NJ+1)*4, 4):</Text-field>
</Input>
</Group>
<Group labelreference="L1854" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">for i from 1 to NJ+1 do 
  Trf_c_Export((i-1)*4+1 .. 4*i, 1..4) := Trf_c(1..4, 1..4, i):
end do:</Text-field>
</Input>
</Group>
<Group labelreference="L1842" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">if codegen_act then
  MatlabExport(convert_t_s(Trf_c_Export), sprintf(&quot;../codeexport/%s/tmp/fkine_mdh_floatb_%s_rotmat_matlab.m&quot;, robot_name, base_method_name), codegen_opt):
end if:</Text-field>
</Input>
</Group>
<Group labelreference="L1838" drawlabel="true">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Export des symbolischen Ausdrucks f\303\274r alle Gelenk-Transformationsmatrizen auf einmal.</Font></Text-field>
</Input>
</Group>
<Group labelreference="L1843" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">Trf_Export := Matrix((NJ)*4, 4):</Text-field>
</Input>
</Group>
<Group labelreference="L1848" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">for i from 1 to NJ do 
  Trf_Export((i-1)*4+1 .. 4*i, 1..4) := Trf(1..4, 1..4, i):
end do:</Text-field>
</Input>
</Group>
<Group labelreference="L1853" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">if codegen_act then
  MatlabExport(convert_t_s(Trf_Export), sprintf(&quot;../codeexport/%s/tmp/joint_transformation_mdh_rotmat_matlab.m&quot;, robot_name), codegen_opt):
end if:</Text-field>
</Input>
</Group>
<Group labelreference="L1844" drawlabel="true">
<Input><Text-field style="Text" layout="Normal">Export ohne letzte Zeile</Text-field>
</Input>
</Group>
<Group labelreference="L1846" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">Trf_Export_m := Matrix((NJ)*3, 4):</Text-field>
</Input>
</Group>
<Group labelreference="L1850" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">for i from 1 to NL do 
  Trf_Export_m((i-1)*3+1 .. 3*i, 1..4) := Trf_c(1..3, 1..4, i):
end do:</Text-field>
</Input>
</Group>
<Group labelreference="L1851" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">if codegen_act then
  MatlabExport(convert_t_s(Trf_Export_m), sprintf(&quot;../codeexport/%s/tmp/joint_transformation_mdh_rotmat_m_matlab.m&quot;, robot_name), codegen_opt):
end if:</Text-field>
</Input>
</Group>
<Group labelreference="L1845" drawlabel="true">
<Input><Text-field style="Text" layout="Normal"><Font encoding="UTF-8">Export des symbolischen Ausdrucks f\303\274r jede Transformationsmatrix einzeln</Font></Text-field>
</Input>
</Group>
<Group labelreference="L1852" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">for i from 1 to NJ+1 do
  if codegen_act and codegen_debug then
    MatlabExport(convert_t_s(Trf_c(1 .. 4, 1 .. 4, i)), sprintf(&quot;../codeexport/%s/tmp/fkine_%d_floatb_%s_rotmat_matlab.m&quot;, robot_name, i, base_method_name), codegen_opt):
  end if:
end do:</Text-field>
</Input>
</Group>
<Group labelreference="L1847" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group>
</Section>
</Section>
</Worksheet>